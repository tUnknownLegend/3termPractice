(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     28975,        674]
NotebookOptionsPosition[     26748,        630]
NotebookOutlinePosition[     27210,        647]
CellTagsIndexPosition[     27167,        644]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"accuracy", " ", "=", " ", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{"-", "10"}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8478730321809683`*^9, 3.847873062865104*^9}},
 CellLabel->
  "In[1137]:=",ExpressionUUID->"d92d75ac-38e1-4738-84d7-55e61ffd2edc"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"hull", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "SetDirectory", "[", "\"\</Users/pinev/Desktop/practice/st\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pairs", " ", "=", " ", 
   RowBox[{"ReadList", "[", 
    RowBox[{"\"\<problem.txt\>\"", ",", " ", "Real"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pairs", " ", "=", " ", 
   RowBox[{"Delete", "[", 
    RowBox[{"pairs", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pairs", "=", 
   RowBox[{"Partition", "[", 
    RowBox[{"pairs", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"amtOfPoint", " ", "=", " ", 
  RowBox[{"Length", "[", "pairs", "]"}]}]}], "Input",
 CellChangeTimes->{
  3.8170533748632736`*^9, {3.817304210664776*^9, 3.81730423204153*^9}, {
   3.8173042866259217`*^9, 3.817304289032182*^9}, {3.817304375818003*^9, 
   3.817304412342889*^9}, {3.8173054015244436`*^9, 3.8173054277027006`*^9}, {
   3.81730547769304*^9, 3.8173054809010572`*^9}, {3.817305816933031*^9, 
   3.8173058286977634`*^9}, {3.817305863627161*^9, 3.817305864715542*^9}, {
   3.817306216965991*^9, 3.817306245495392*^9}, {3.817306646488448*^9, 
   3.817306663064705*^9}, {3.817530277418449*^9, 3.8175303129542522`*^9}, {
   3.817530466462803*^9, 3.817530494308848*^9}, {3.81753057374508*^9, 
   3.817530597630519*^9}, {3.8175332109413366`*^9, 3.817533260898604*^9}, {
   3.842963708069722*^9, 3.842963737951791*^9}, {3.847860745417675*^9, 
   3.8478607721289835`*^9}, {3.8478608837097692`*^9, 3.847860972625922*^9}, {
   3.84786120514859*^9, 3.8478612530905924`*^9}, 3.847861376041807*^9, {
   3.8478619317396603`*^9, 3.8478619363062925`*^9}, {3.847866397152729*^9, 
   3.847866397490104*^9}, {3.847866446184563*^9, 3.84786644620156*^9}, 
   3.8478686993011446`*^9, 3.8478687863286886`*^9, 3.8478690132044973`*^9, {
   3.8478690989657497`*^9, 3.8478692291990037`*^9}, {3.8478747066227393`*^9, 
   3.847874707411307*^9}, {3.8478748508330297`*^9, 3.847874851225175*^9}, {
   3.8478755504005947`*^9, 3.8478755539733686`*^9}},
 CellLabel->
  "In[1138]:=",ExpressionUUID->"de1ecbb4-b5bf-4898-b9ea-011030fcdb56"],

Cell[BoxData["20"], "Output",
 CellChangeTimes->{{3.847870190060949*^9, 3.8478702142854977`*^9}, 
   3.847870861441719*^9, 3.847870947074068*^9, 3.847870980116295*^9, {
   3.847872781958682*^9, 3.8478728274170017`*^9}, 3.8478730655586367`*^9, 
   3.847873812024397*^9, 3.8478740159065156`*^9, {3.847874052507265*^9, 
   3.8478740711350183`*^9}, 3.84787440690421*^9, 3.847874460349799*^9, 
   3.847874712210878*^9, 3.847874852453922*^9, 3.847874899449649*^9, 
   3.8478749662943583`*^9, 3.8478752496597805`*^9, {3.8478753984430428`*^9, 
   3.847875412255648*^9}, {3.847875551016247*^9, 3.847875554451397*^9}, {
   3.847875640758458*^9, 3.8478756641696277`*^9}, {3.8478758208257775`*^9, 
   3.847875841574606*^9}, 3.8478759444115353`*^9, 3.8478760498797646`*^9, 
   3.847876094853776*^9, {3.8478761431158395`*^9, 3.847876232064163*^9}, 
   3.847876603978447*^9, 3.84787673581598*^9, {3.847876976458571*^9, 
   3.8478770036728115`*^9}, 3.8478805009506936`*^9, {3.8478807967869797`*^9, 
   3.8478808403829155`*^9}, 3.847892828384633*^9},
 CellLabel->
  "Out[1143]=",ExpressionUUID->"6a7d03a2-7efa-4009-974b-8ef031fa78c5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pairs", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.847874356963689*^9, 3.8478743669742956`*^9}, {
  3.8478760147517815`*^9, 3.8478760240851355`*^9}, {3.8478760633388133`*^9, 
  3.847876063447468*^9}},
 CellLabel->
  "In[1144]:=",ExpressionUUID->"5d5582ba-b380-47e7-8b14-a47444b41c34"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.1115183308624985`", ",", "0.4754586991889034`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.847874367664317*^9, 3.8478744069516754`*^9, 3.8478744603983994`*^9, 
   3.847874712272795*^9, 3.8478748994946594`*^9, 3.8478749663533125`*^9, 
   3.8478752497168055`*^9, {3.847875398495101*^9, 3.8478754122957726`*^9}, {
   3.8478756408080697`*^9, 3.847875664221534*^9}, {3.84787582087772*^9, 
   3.8478758416219387`*^9}, 3.8478759444616346`*^9, {3.8478760184705687`*^9, 
   3.847876064054267*^9}, 3.847876094902089*^9, {3.847876143161831*^9, 
   3.8478762321157355`*^9}, 3.847876604029649*^9, 3.8478767358718357`*^9, {
   3.8478769765223155`*^9, 3.847877003733071*^9}, 3.847880501001687*^9, {
   3.847880796837867*^9, 3.84788084043018*^9}, 3.8478928284099183`*^9},
 CellLabel->
  "Out[1144]=",ExpressionUUID->"919f9153-9909-4718-b2c2-715e779b7816"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pairs", "[", 
  RowBox[{"[", "20", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8478743717707357`*^9, 3.847874374337558*^9}, {
  3.8478746829797535`*^9, 3.8478746954653616`*^9}},
 CellLabel->
  "In[1145]:=",ExpressionUUID->"07572273-ecf3-4816-8a1b-4e6967ca973b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.2822907008759863`", ",", "0.7084251701634474`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.8478743749712877`*^9, 3.8478744070052443`*^9, 3.847874460445663*^9, {
   3.847874684356499*^9, 3.84787471233247*^9}, 3.8478748995423036`*^9, 
   3.8478749664163218`*^9, 3.8478752497757177`*^9, {3.8478753985457196`*^9, 
   3.8478754123334146`*^9}, {3.8478756408556805`*^9, 
   3.8478756642811947`*^9}, {3.847875820930732*^9, 3.8478758416695848`*^9}, 
   3.8478759445131063`*^9, 3.8478760500611324`*^9, 3.8478760949507303`*^9, {
   3.8478761432099204`*^9, 3.8478762321674123`*^9}, 3.847876604076654*^9, 
   3.847876735929143*^9, {3.8478769765820227`*^9, 3.847877003793329*^9}, 
   3.847880501047714*^9, {3.8478807968834114`*^9, 3.8478808404772015`*^9}, 
   3.8478928284356537`*^9},
 CellLabel->
  "Out[1145]=",ExpressionUUID->"f8cd9795-323f-447f-8ef5-47f5a3383602"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LineL", "[", 
    RowBox[{"p1_", ",", " ", "p2_", ",", " ", "p_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "-", 
       RowBox[{"p1", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"p2", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "-", 
       RowBox[{"p1", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "-", 
       RowBox[{"p1", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"p2", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "-", 
       RowBox[{"p1", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.847870736813591*^9, 3.847870806425812*^9}, {
  3.847870895920794*^9, 3.8478708959826765`*^9}},
 CellLabel->
  "In[1146]:=",ExpressionUUID->"5433b5d8-3a80-4c5f-9c90-a78a18bfb8ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DetSide", "[", 
   RowBox[{"p1_", ",", "p2_", ",", "p_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", ",", "Side"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"res", ":=", 
      RowBox[{"LineL", "[", 
       RowBox[{"p1", ",", " ", "p2", ",", " ", "p"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"res", "<", "0"}], ",", " ", 
       RowBox[{"Side", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"res", " ", ">", " ", "0"}], ",", " ", 
         RowBox[{"Side", " ", "=", " ", 
          RowBox[{"-", "1"}]}], ",", " ", "0"}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "Side"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{
  3.8175328573419385`*^9, 3.8175335308289995`*^9, {3.8175335889330873`*^9, 
   3.817533607030673*^9}, {3.817533641193391*^9, 3.817533643106574*^9}, {
   3.8175336742857733`*^9, 3.8175336773344393`*^9}, {3.8175337170192385`*^9, 
   3.817533722219612*^9}, {3.8478614911598864`*^9, 3.847861525196639*^9}, {
   3.847861558826837*^9, 3.847861660764558*^9}, 3.847869567880395*^9, {
   3.847869637981579*^9, 3.8478697211376057`*^9}, {3.8478698025118494`*^9, 
   3.8478699251859217`*^9}, {3.8478708229701047`*^9, 
   3.8478708373599715`*^9}, {3.8478709451236696`*^9, 3.8478709454915714`*^9}},
 CellLabel->
  "In[1147]:=",ExpressionUUID->"b6ca1b85-819b-4788-a283-7126fad5a566"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LineDist", "[", 
    RowBox[{"p1_", ",", "p2_", ",", "p_"}], "]"}], ":=", 
   RowBox[{"Abs", "[", 
    RowBox[{"LineL", "[", 
     RowBox[{"p1", ",", " ", "p2", ",", " ", "p"}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8478708724921703`*^9, 3.8478708887252617`*^9}, {
  3.847870951871574*^9, 3.847870978907113*^9}},
 CellLabel->
  "In[1148]:=",ExpressionUUID->"cd67828c-6459-4fe2-a215-29490df419b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"QuickH", "[", 
   RowBox[{"P_List", ",", " ", "p1_", ",", " ", "p2_", ",", " ", "side_"}], 
   "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "currentI", ",", " ", "maxDist", ",", " ", "i", ",", " ", "dist"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"currentI", " ", "=", " ", 
      RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"maxDist", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"i", " ", "<=", " ", "amtOfPoint"}], ",", " ", 
       RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dist", " ", ":=", " ", 
         RowBox[{"LineDist", "[", 
          RowBox[{"p1", ",", " ", "p2", ",", " ", 
           RowBox[{"pairs", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"DetSide", "[", 
               RowBox[{"p1", ",", " ", "p2", ",", " ", 
                RowBox[{"pairs", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], " ", "==", " ", 
              "side"}], ")"}], " ", "&&", 
            RowBox[{"(", 
             RowBox[{"dist", " ", ">", " ", "maxDist"}], ")"}]}], ")"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"currentI", " ", "=", " ", "i"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"maxDist", " ", "=", " ", "dist"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"currentI", " ", "==", " ", 
         RowBox[{"-", "1"}]}], ")"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"hull", ",", "p1"}], "]"}], ";", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"hull", ",", "p2"}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"hull", ",", "p1"}], "]"}], ")"}]}], ")"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"hull", ",", "p1"}], "]"}]}], "]"}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"hull", ",", "p2"}], "]"}], ")"}]}], ")"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"hull", ",", "p2"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"QuickH", "[", 
      RowBox[{"P", ",", " ", 
       RowBox[{"pairs", "[", 
        RowBox[{"[", "currentI", "]"}], "]"}], ",", " ", "p1", ",", " ", 
       RowBox[{"-", 
        RowBox[{"DetSide", "[", 
         RowBox[{
          RowBox[{"pairs", "[", 
           RowBox[{"[", "currentI", "]"}], "]"}], ",", " ", "p1", ",", " ", 
          "p2"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"QuickH", "[", 
      RowBox[{"P", ",", " ", 
       RowBox[{"pairs", "[", 
        RowBox[{"[", "currentI", "]"}], "]"}], ",", " ", "p2", ",", " ", 
       RowBox[{"-", 
        RowBox[{"DetSide", "[", 
         RowBox[{
          RowBox[{"pairs", "[", 
           RowBox[{"[", "currentI", "]"}], "]"}], ",", " ", "p2", ",", " ", 
          "p1"}], "]"}]}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.847871018550996*^9, 3.8478710402122035`*^9}, {
   3.847871229485067*^9, 3.847871295273218*^9}, {3.8478713409921494`*^9, 
   3.8478713417944946`*^9}, {3.8478714155238357`*^9, 3.847871420274062*^9}, {
   3.8478714655712414`*^9, 3.8478715638790617`*^9}, {3.8478716585179896`*^9, 
   3.847871701183853*^9}, {3.847871863555333*^9, 3.8478721083930473`*^9}, {
   3.8478722392758155`*^9, 3.8478722546191607`*^9}, {3.8478722954747524`*^9, 
   3.847872358783885*^9}, {3.8478725406422443`*^9, 3.8478727031881056`*^9}, {
   3.847872756850924*^9, 3.847872824711159*^9}, {3.847872873325841*^9, 
   3.847872879665538*^9}, {3.8478739695087185`*^9, 3.8478740695776763`*^9}, {
   3.847874438352932*^9, 3.8478744441264777`*^9}, 3.8478748977719116`*^9, {
   3.8478756358131323`*^9, 3.847875696760227*^9}, {3.8478758277216387`*^9, 
   3.847875840345994*^9}, {3.8478759206375265`*^9, 3.847875991813797*^9}, {
   3.847876131973694*^9, 3.847876183371147*^9}, {3.8478765846658955`*^9, 
   3.8478765926174903`*^9}},
 CellLabel->
  "In[1149]:=",ExpressionUUID->"f986d990-874c-476d-b2c2-30e2f6fb41a9"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"calcHull", "[", "P_List", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"min", ",", " ", "max", ",", " ", "i"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"amtOfPoint", "<", "3"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<It's not possible to convex hull, amtOfPoint < 3\>\"", ";", 
          "Abort"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"min", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"max", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", " ", "=", " ", "2"}], ",", " ", 
        RowBox[{"i", " ", "<=", " ", "amtOfPoint"}], ",", " ", 
        RowBox[{"++", "i"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pairs", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "1"}], "]"}], "]"}], " ", "<", " ", 
            RowBox[{"pairs", "[", 
             RowBox[{"[", 
              RowBox[{"min", ",", " ", "1"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"min", " ", "=", " ", "i"}], ";"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pairs", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "1"}], "]"}], "]"}], " ", ">", " ", 
            RowBox[{"pairs", "[", 
             RowBox[{"[", 
              RowBox[{"max", ",", " ", "1"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"max", " ", "=", " ", "i"}], ";"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"pairs", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", " ", "1"}], "]"}], "]"}], " ", "-", " ", 
                  RowBox[{"pairs", "[", 
                   RowBox[{"[", 
                    RowBox[{"min", ",", " ", "1"}], "]"}], "]"}]}], ")"}], 
                "]"}], " ", "<", " ", "accuracy"}], ")"}], " ", "&&", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"pairs", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", " ", "2"}], "]"}], "]"}], " ", "<", " ", 
               RowBox[{"pairs", "[", 
                RowBox[{"[", 
                 RowBox[{"min", ",", " ", "2"}], "]"}], "]"}]}], ")"}]}], 
            ")"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"min", " ", "=", " ", "i"}], ";"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"pairs", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", " ", "1"}], "]"}], "]"}], " ", "-", " ", 
                  RowBox[{"pairs", "[", 
                   RowBox[{"[", 
                    RowBox[{"max", ",", " ", "1"}], "]"}], "]"}]}], ")"}], 
                "]"}], " ", "<", " ", "accuracy"}], ")"}], " ", "&&", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"pairs", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", " ", "2"}], "]"}], "]"}], " ", ">", " ", 
               RowBox[{"pairs", "[", 
                RowBox[{"[", 
                 RowBox[{"max", ",", " ", "2"}], "]"}], "]"}]}], ")"}]}], 
            ")"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"max", " ", "=", " ", "i"}], ";"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"QuickH", "[", 
       RowBox[{"P", ",", " ", 
        RowBox[{"pairs", "[", 
         RowBox[{"[", "min", "]"}], "]"}], ",", " ", 
        RowBox[{"pairs", "[", 
         RowBox[{"[", "max", "]"}], "]"}], ",", " ", "1"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"QuickH", "[", 
       RowBox[{"P", ",", " ", 
        RowBox[{"pairs", "[", 
         RowBox[{"[", "min", "]"}], "]"}], ",", " ", 
        RowBox[{"pairs", "[", 
         RowBox[{"[", "max", "]"}], "]"}], ",", " ", 
        RowBox[{"-", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"hull", "=", 
       RowBox[{"Sort", "[", "hull", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"hull", ",", 
        RowBox[{"hull", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "@", "P"}], ",", " ", 
         RowBox[{"Line", "@", "hull"}]}], "}"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.847872891922016*^9, 3.847872983393197*^9}, {
   3.847873081131909*^9, 3.847873085469925*^9}, {3.8478731295911837`*^9, 
   3.8478731580110545`*^9}, 3.8478731886947308`*^9, {3.847873227069496*^9, 
   3.8478732594302673`*^9}, {3.8478732992097883`*^9, 
   3.8478734355772243`*^9}, {3.847873472292877*^9, 3.847873536567398*^9}, {
   3.847873597539324*^9, 3.847873749717141*^9}, {3.847873779888831*^9, 
   3.8478738099434648`*^9}, 3.8478740934306335`*^9, 3.8478742478380413`*^9, 
   3.8478744042979765`*^9, {3.8478744577305913`*^9, 3.847874457815618*^9}, 
   3.8478749638851423`*^9, {3.8478752482146597`*^9, 3.8478752485975695`*^9}, {
   3.8478753840372915`*^9, 3.8478753969019957`*^9}, {3.8478757857990017`*^9, 
   3.847875786221966*^9}, {3.847876092372882*^9, 3.847876093746481*^9}, {
   3.847876203118393*^9, 3.847876230717225*^9}, {3.8478767244766445`*^9, 
   3.8478767340126286`*^9}, {3.8478769737560387`*^9, 3.847877002174904*^9}, {
   3.8478804876922593`*^9, 3.8478804995063925`*^9}, {3.84788079427654*^9, 
   3.8478808394297385`*^9}},
 CellLabel->
  "In[1150]:=",ExpressionUUID->"73bc42d3-5bcc-49fc-9828-334ce269c0a7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"calcHull", "[", "pairs", "]"}]], "Input",
 CellChangeTimes->{{3.847873820036833*^9, 3.847873824476552*^9}},
 CellLabel->
  "In[1151]:=",ExpressionUUID->"48232811-2bc1-48b2-b607-7cb63e332ce0"],

Cell[BoxData[
 GraphicsBox[{PointBox[CompressedData["
1:eJwBUQGu/iFib1JlAgAAABQAAAACAAAA0Ff/ccfI8T/YXOdS6m3eP/RFaT3n
A/C/EDSiVPFlwz+ArcjiQ3ijv+gY0j85Ed+/mFhYOj6n+L9ohncubUzuP8BF
WK1TpsK/gBbmgwZE4L8QuxaTmBPnv0j2fJQyxtA/pFxsBrIy8b/QUnEapoPk
PwAJCry8Bcg/4LQ1g27Wvz8QutZkMnzUv4ylcehJmOK/cGyNy36/9L+g9LgV
bwvrPwAznPPfxfK/tKp62QuV4j/YeuIKGkjrv8QCmfvwl+c/uLbMxQhL5T/o
Qps3ffbcP0gQDXjNJfq//B557crE479A6EqxjsPyP5B5x/TxT8A/8M/a/O0X
6j8oagNkmPbdv5jjI3svo+K/eHII52k42j/wMFHjEuv3PzgrrJBxK9g/IN3B
3+/y3j/4jJZXxb7lP/CiA0FDhPQ/3HwwQ2ur5j9pK7HL
    "]], LineBox[{{-1.6342291535847995`, -0.6177725446841289}, \
{-1.540830829535059, 
    0.94682940555158}, {-0.3200803742173841, -0.5810899295731118}, {
    0.8154210985726404, -0.4681759812062034}, {1.2822907008759863`, 
    0.7084251701634474}, {1.49489105983508, 
    0.37765158775498575`}, {-1.6342291535847995`, -0.6177725446841289}}]}]], \
"Output",
 CellChangeTimes->{
  3.847873826349248*^9, 3.8478740163248777`*^9, {3.847874052867072*^9, 
   3.847874071461639*^9}, 3.847874407361531*^9, 3.847874460762458*^9, 
   3.847874712760515*^9, 3.8478748998609114`*^9, 3.847874966755607*^9, 
   3.8478752500925508`*^9, {3.8478753987802305`*^9, 3.8478754125458207`*^9}, {
   3.847875641147114*^9, 3.8478756646125298`*^9}, {3.8478758212086363`*^9, 
   3.847875841944663*^9}, 3.847875944821398*^9, 3.8478760503799534`*^9, 
   3.8478760951428595`*^9, {3.847876143410597*^9, 3.847876232365821*^9}, 
   3.8478766042835417`*^9, 3.8478767361560163`*^9, {3.8478769768311577`*^9, 
   3.8478770041284847`*^9}, 3.8478805012144775`*^9, {3.847880797051798*^9, 
   3.847880840635659*^9}, 3.847892828515534*^9},
 CellLabel->
  "Out[1151]=",ExpressionUUID->"2164790e-788a-42de-9bde-f7755d292dca"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["hull"], "Input",
 CellChangeTimes->{{3.847873857377037*^9, 3.847873858021035*^9}, {
  3.8478752622374563`*^9, 3.8478752721519485`*^9}, {3.8478754075720005`*^9, 
  3.847875408380186*^9}, {3.84787585061654*^9, 3.847875860884673*^9}},
 CellLabel->
  "In[1152]:=",ExpressionUUID->"c48c845e-cb27-4990-8c5e-aaf1692c52d5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.6342291535847995`"}], ",", 
     RowBox[{"-", "0.6177725446841289`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.540830829535059`"}], ",", "0.94682940555158`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.3200803742173841`"}], ",", 
     RowBox[{"-", "0.5810899295731118`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8154210985726404`", ",", 
     RowBox[{"-", "0.4681759812062034`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.2822907008759863`", ",", "0.7084251701634474`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.49489105983508`", ",", "0.37765158775498575`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.6342291535847995`"}], ",", 
     RowBox[{"-", "0.6177725446841289`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8478738585591*^9, 3.8478740163828955`*^9, {3.847874052915558*^9, 
   3.847874071513651*^9}, 3.847874407414542*^9, 3.8478744608163576`*^9, 
   3.847874712826993*^9, 3.8478748999049215`*^9, {3.8478749668237486`*^9, 
   3.847874986491237*^9}, {3.8478752501553693`*^9, 3.847875272537643*^9}, {
   3.8478753988398123`*^9, 3.847875414390585*^9}, {3.8478756411985607`*^9, 
   3.8478756646635413`*^9}, {3.8478758212632523`*^9, 3.8478758615824766`*^9}, 
   3.847875944872465*^9, 3.847876050440382*^9, 3.84787609518897*^9, {
   3.8478761434597125`*^9, 3.847876232419326*^9}, 3.8478766043355827`*^9, 
   3.84787673621157*^9, {3.8478769768932056`*^9, 3.8478770041890793`*^9}, 
   3.847880501263489*^9, {3.847880797101149*^9, 3.847880840685892*^9}, 
   3.8478928285405674`*^9},
 CellLabel->
  "Out[1152]=",ExpressionUUID->"2fda4edb-5329-4973-9ceb-2a3fc4c4f914"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "hull", "]"}]], "Input",
 CellChangeTimes->{{3.8478749247592506`*^9, 3.8478749444376154`*^9}, {
  3.8478749746862373`*^9, 3.8478749783757353`*^9}},
 CellLabel->
  "In[1153]:=",ExpressionUUID->"aeb5e952-575e-41d2-9783-05d808d81315"],

Cell[BoxData["7"], "Output",
 CellChangeTimes->{{3.8478749312759356`*^9, 3.847874979047103*^9}, 
   3.8478752502189603`*^9, {3.847875398895855*^9, 3.8478754126354513`*^9}, {
   3.8478756412498555`*^9, 3.8478756647195897`*^9}, {3.847875821318247*^9, 
   3.84787584204585*^9}, 3.847875944917499*^9, 3.847876050507062*^9, 
   3.8478760952339544`*^9, {3.847876143506812*^9, 3.8478762324711466`*^9}, 
   3.8478766043881025`*^9, 3.847876736269162*^9, {3.847876976951685*^9, 
   3.847877004249093*^9}, 3.8478805013116074`*^9, {3.847880797155534*^9, 
   3.847880840735903*^9}, 3.8478928285526543`*^9},
 CellLabel->
  "Out[1153]=",ExpressionUUID->"37aa568f-2fe3-4854-9afd-197d9bea4756"]
}, Open  ]]
},
WindowSize->{1063.3846153846155`, 536.6769230769231},
WindowMargins->{{
  Automatic, -4.984615384615381}, {-4.984615384615381, Automatic}},
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"08a2627b-c536-494a-8747-afccf923655a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 308, 8, 28, "Input",ExpressionUUID->"d92d75ac-38e1-4738-84d7-55e61ffd2edc"],
Cell[CellGroupData[{
Cell[891, 32, 2219, 43, 124, "Input",ExpressionUUID->"de1ecbb4-b5bf-4898-b9ea-011030fcdb56"],
Cell[3113, 77, 1117, 16, 32, "Output",ExpressionUUID->"6a7d03a2-7efa-4009-974b-8ef031fa78c5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4267, 98, 337, 7, 28, "Input",ExpressionUUID->"5d5582ba-b380-47e7-8b14-a47444b41c34"],
Cell[4607, 107, 885, 15, 32, "Output",ExpressionUUID->"919f9153-9909-4718-b2c2-715e779b7816"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5529, 127, 287, 6, 28, "Input",ExpressionUUID->"07572273-ecf3-4816-8a1b-4e6967ca973b"],
Cell[5819, 135, 900, 16, 32, "Output",ExpressionUUID->"f8cd9795-323f-447f-8ef5-47f5a3383602"]
}, Open  ]],
Cell[6734, 154, 1150, 35, 67, "Input",ExpressionUUID->"5433b5d8-3a80-4c5f-9c90-a78a18bfb8ca"],
Cell[7887, 191, 1586, 35, 143, "Input",ExpressionUUID->"b6ca1b85-819b-4788-a283-7126fad5a566"],
Cell[9476, 228, 463, 12, 28, "Input",ExpressionUUID->"cd67828c-6459-4fe2-a215-29490df419b2"],
Cell[9942, 242, 5121, 118, 542, "Input",ExpressionUUID->"f986d990-874c-476d-b2c2-30e2f6fb41a9"],
Cell[15066, 362, 6600, 153, 523, "Input",ExpressionUUID->"73bc42d3-5bcc-49fc-9828-334ce269c0a7"],
Cell[CellGroupData[{
Cell[21691, 519, 215, 4, 28, "Input",ExpressionUUID->"48232811-2bc1-48b2-b607-7cb63e332ce0"],
Cell[21909, 525, 1709, 29, 203, "Output",ExpressionUUID->"2164790e-788a-42de-9bde-f7755d292dca"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23655, 559, 329, 5, 28, "Input",ExpressionUUID->"c48c845e-cb27-4990-8c5e-aaf1692c52d5"],
Cell[23987, 566, 1759, 39, 52, "Output",ExpressionUUID->"2fda4edb-5329-4973-9ceb-2a3fc4c4f914"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25783, 610, 269, 5, 28, "Input",ExpressionUUID->"aeb5e952-575e-41d2-9783-05d808d81315"],
Cell[26055, 617, 677, 10, 54, "Output",ExpressionUUID->"37aa568f-2fe3-4854-9afd-197d9bea4756"]
}, Open  ]]
}
]
*)

